## 深圳爬墙区新手村指南 · 展示站（FastAPI + HTML）

把 `深圳市爬墙区新手村指南.xlsx` 的内容做成可浏览/可搜索的展示网站，并挂载在 FastAPI 下。
首次启动会把 Excel **导入到 SQLite（`data.db`）**，后续网页上的增删改都会写入数据库（不再依赖 Excel 读写）。

### 目录结构（关键文件）

- `main.py`: FastAPI 应用（读取 Excel、渲染模板、挂载图片目录）
- `深圳市爬墙区新手村指南.xlsx`: 数据源（会自动读取所有工作表）
- `图片/`: 图片目录（会挂载到 `/images`）
- `data.db`: SQLite 数据库（Excel 首次导入后的持久化存储；网页增删改都写这里）
- `templates/`: 页面模板
- `static/`: CSS 等静态资源

### 安装依赖

在项目根目录执行：

```bash
pip install -r requirements.txt
```

### 运行

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

打开 `http://127.0.0.1:8000/` 即可浏览。

### 说明

- **主页是约攀**：访问 `/`（或 `/events`）进入“约攀接龙报名”主页。
  - 发起活动：时间 / 地点 / 发起昵称
  - 报名接龙：在活动下追加自己的昵称；也可以删除昵称或删除活动（公共可编辑）
  - 仅允许未来 5 天内的活动；过期活动标红并只展示最近 5 条过期记录
- **指南页面**：访问 `/guide` 查看 Excel 导入后的指南内容。
- **自动导航**：Excel 的每个工作表会自动生成一个 Tab。
- **搜索/筛选**：支持关键词搜索 + 指定列“包含”筛选。
- **图片展示（有条件启用）**：只有当某个工作表存在列名包含「图片 / image / img / 照片 / 封面」时，该工作表才会启用图片展示；每行最多展示 1 张图片。
  - 你可以把图片文件名填到这列里（如 `abc.png`），图片放在 `图片/` 目录即可显示。
  - 页面也提供上传入口：在启用图片列的工作表页面，上传后会返回文件名，你复制填回 Excel 的图片列即可。
- **网页编辑（增删改）**：默认开启。页面右侧会出现“进入编辑”，可新增/编辑/删除行，修改立即写入 `data.db`。
  - 注意：未做登录鉴权，任何能访问网站的人都能改数据（符合“公共可编辑”需求）。
- **刷新 Excel（可选）**：默认会缓存 Excel 读取结果；如果你希望不重启服务就刷新数据：
  - 启动前设置环境变量 `ENABLE_GUIDE_RELOAD=1`
  - 然后访问 `/reload` 会清缓存并跳回首页

### 贡献者

致敬每一位开发者！

[![Contributors](https://contrib.rocks/image?repo=YHao-o/climb-buddy-board)](https://github.com/YHao-o/climb-buddy-board/graphs/contributors)
